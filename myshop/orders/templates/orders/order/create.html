{% extends "shop/base.html" %}

{% block title %}
  Datos de la orden
{% endblock %}

{% block content %}
  {% if not user.is_authenticated %}
    <p>Por favor, inicia sesi√≥n para completar tu compra.</p>
  {% else %}

  {%if cart %}
  <h1>Datos de la orden</h1>

  <div class="order-info">
    <h3>Tu orden</h3>
    <ul>
      {% for item in cart %}
        <li>
          {{ item.quantity }}x {{ item.product.name }}
          <span>${{ item.total_price }}</span>
        </li>
      {% endfor %}
    </ul>
    <p>Total: ${{ cart.get_total_price }}</p>
  </div>
  {% if not valid %}
    <p>{{ invalid }}</p>
  {% endif %}
  <form action="." method="post" class="order-form">
    {{ form.as_p }}
    <p><input type="submit" value="Recoger en tienda" name="store_pickup"></p>
    {% csrf_token %}
    {% if cart.get_total_price >= 500 %}
      <p><input type="submit" value="Entregar a domicilio" name="home_delivery"></p>
      {% csrf_token %}
    {% else %}
      <p><input type="button" value="Entrega a domicilio en compras desde 500"></p>
    {% endif %}

  </form>
  {% else %}
  <p>Por favor, ingresa productos a tu carrito para confirmar la compra.</p>
  {% endif %}

  {% endif %}
{% endblock %}